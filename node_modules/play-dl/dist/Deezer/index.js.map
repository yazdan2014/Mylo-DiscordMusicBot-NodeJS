{"version":3,"file":"index.js","sourceRoot":"","sources":["../../play-dl/Deezer/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { URL } from 'url';\r\nimport { request, request_resolve_redirect } from '../Request';\r\nimport { DeezerAlbum, DeezerPlaylist, DeezerTrack } from './classes';\r\n\r\ninterface TypeData {\r\n    type: 'track' | 'playlist' | 'album' | 'search' | false;\r\n    id?: string;\r\n    error?: string;\r\n}\r\n\r\ninterface DeezerSearchOptions {\r\n    type?: 'track' | 'playlist' | 'album';\r\n    limit?: number;\r\n    fuzzy?: boolean;\r\n}\r\n\r\ninterface DeezerAdvancedSearchOptions {\r\n    limit?: number;\r\n    artist?: string;\r\n    album?: string;\r\n    title?: string;\r\n    label?: string;\r\n    minDurationInSec?: number;\r\n    maxDurationInSec?: number;\r\n    minBPM?: number;\r\n    maxBPM?: number;\r\n}\r\n\r\nasync function internalValidate(url: string): Promise<TypeData> {\r\n    let urlObj;\r\n    try {\r\n        // will throw a TypeError if the input is not a valid URL so we need to catch it\r\n        urlObj = new URL(url);\r\n    } catch {\r\n        return { type: 'search' };\r\n    }\r\n\r\n    if (urlObj.protocol !== 'https:' && urlObj.protocol !== 'http:') {\r\n        return { type: 'search' };\r\n    }\r\n\r\n    let pathname = urlObj.pathname;\r\n    if (pathname.endsWith('/')) {\r\n        pathname = pathname.slice(0, -1);\r\n    }\r\n    const path = pathname.split('/');\r\n    switch (urlObj.hostname) {\r\n        case 'deezer.com':\r\n        case 'www.deezer.com': {\r\n            if (path.length === 4) {\r\n                const lang = path.splice(1, 1)[0];\r\n                if (!lang.match(/^[a-z]{2}$/)) {\r\n                    return { type: false };\r\n                }\r\n            } else if (path.length !== 3) {\r\n                return { type: false };\r\n            }\r\n\r\n            if ((path[1] === 'track' || path[1] === 'album' || path[1] === 'playlist') && path[2].match(/^[0-9]+$/)) {\r\n                return {\r\n                    type: path[1],\r\n                    id: path[2]\r\n                };\r\n            } else {\r\n                return { type: false };\r\n            }\r\n        }\r\n        case 'api.deezer.com': {\r\n            if (\r\n                path.length === 3 &&\r\n                (path[1] === 'track' || path[1] === 'album' || path[1] === 'playlist') &&\r\n                path[2].match(/^[0-9]+$/)\r\n            ) {\r\n                return {\r\n                    type: path[1],\r\n                    id: path[2]\r\n                };\r\n            } else {\r\n                return { type: false };\r\n            }\r\n        }\r\n        case 'deezer.page.link': {\r\n            if (path.length === 2 && path[1].match(/^[A-Za-z0-9]+$/)) {\r\n                const resolved = await request_resolve_redirect(url).catch((err) => err);\r\n\r\n                if (resolved instanceof Error) {\r\n                    return { type: false, error: resolved.message };\r\n                }\r\n\r\n                return await internalValidate(resolved);\r\n            } else {\r\n                return { type: false };\r\n            }\r\n        }\r\n        default:\r\n            return { type: 'search' };\r\n    }\r\n}\r\n\r\n/**\r\n * Shared type for Deezer tracks, playlists and albums\r\n */\r\nexport type Deezer = DeezerTrack | DeezerPlaylist | DeezerAlbum;\r\n\r\n/**\r\n * Fetches the information for a track, playlist or album on Deezer\r\n * @param url The track, playlist or album URL\r\n * @returns A {@link DeezerTrack}, {@link DeezerPlaylist} or {@link DeezerAlbum}\r\n * object depending on the provided URL.\r\n */\r\nexport async function deezer(url: string): Promise<Deezer> {\r\n    const typeData = await internalValidate(url);\r\n\r\n    if (typeData.error) {\r\n        throw new Error(`This is not a Deezer track, playlist or album URL:\\n${typeData.error}`);\r\n    } else if (!typeData.type || typeData.type === 'search')\r\n        throw new Error('This is not a Deezer track, playlist or album URL');\r\n\r\n    const response = await request(`https://api.deezer.com/${typeData.type}/${typeData.id}`).catch((err: Error) => err);\r\n\r\n    if (response instanceof Error) throw response;\r\n\r\n    const jsonData = JSON.parse(response);\r\n\r\n    if (jsonData.error) {\r\n        throw new Error(`Deezer API Error: ${jsonData.error.type}: ${jsonData.error.message}`);\r\n    }\r\n\r\n    switch (typeData.type) {\r\n        case 'track':\r\n            return new DeezerTrack(jsonData, false);\r\n        case 'playlist':\r\n            return new DeezerPlaylist(jsonData, false);\r\n        case 'album':\r\n            return new DeezerAlbum(jsonData, false);\r\n    }\r\n}\r\n\r\n/**\r\n * Validates a Deezer URL\r\n * @param url The URL to validate\r\n * @returns The type of the URL either 'track', 'playlist', 'album', 'search' or false.\r\n * false means that the provided URL was a wrongly formatted or unsupported Deezer URL.\r\n */\r\nexport async function dz_validate(url: string): Promise<'track' | 'playlist' | 'album' | 'search' | false> {\r\n    const typeData = await internalValidate(url);\r\n    return typeData.type;\r\n}\r\n\r\n/**\r\n * Searches Deezer for tracks, playlists or albums\r\n * @param query The search query\r\n * @param options Extra options to configure the search:\r\n *\r\n * * type?: The type to search for `'track'`, `'playlist'` or `'album'`. Defaults to `'track'`.\r\n * * limit?: The maximum number of results to return, maximum `100`, defaults to `10`.\r\n * * fuzzy?: Whether the search should be fuzzy or only return exact matches. Defaults to `true`.\r\n * @returns An array of tracks, playlists or albums\r\n */\r\nexport async function dz_search(query: string, options: DeezerSearchOptions): Promise<Deezer[]> {\r\n    let query_ = query.trim();\r\n\r\n    const type = options.type ?? 'track';\r\n    const limit = options.limit ?? 10;\r\n    const fuzzy = options.fuzzy ?? true;\r\n\r\n    if (query_.length === 0) throw new Error('A query is required to search.');\r\n    if (limit > 100) throw new Error('The maximum search limit for Deezer is 100');\r\n    if (limit < 1) throw new Error('The minimum search limit for Deezer is 1');\r\n    if (type !== 'track' && type !== 'album' && type != 'playlist')\r\n        throw new Error(`\"${type}\" is not a valid Deezer search type`);\r\n\r\n    query_ = encodeURIComponent(query_);\r\n    const response = await request(\r\n        `https://api.deezer.com/search/${type}/?q=${query_}&limit=${limit}${fuzzy ? '' : 'strict=on'}`\r\n    ).catch((err: Error) => err);\r\n\r\n    if (response instanceof Error) throw response;\r\n\r\n    const jsonData = JSON.parse(response);\r\n\r\n    if (jsonData.error) {\r\n        throw new Error(`Deezer API Error: ${jsonData.error.type}: ${jsonData.error.message}`);\r\n    }\r\n\r\n    let results: Deezer[] = [];\r\n    switch (type) {\r\n        case 'track':\r\n            results = jsonData.data.map((track: any) => new DeezerTrack(track, true));\r\n            break;\r\n        case 'playlist':\r\n            results = jsonData.data.map((playlist: any) => new DeezerPlaylist(playlist, true));\r\n            break;\r\n        case 'album':\r\n            results = jsonData.data.map((album: any) => new DeezerAlbum(album, true));\r\n            break;\r\n    }\r\n\r\n    return results;\r\n}\r\n\r\n/**\r\n * Searches Deezer for tracks using the specified metadata.\r\n * @param options The metadata and limit for the search\r\n *\r\n * * limit?: The maximum number of results to return, maximum `100`, defaults to `10`.\r\n * * artist?: The name of the artist\r\n * * album?: The title of the album\r\n * * title?: The title of the track\r\n * * label?: The label that released the track\r\n * * minDurationInSec?: The minimum duration in seconds\r\n * * maxDurationInSec?: The maximum duration in seconds\r\n * * minBpm?: The minimum BPM\r\n * * maxBpm?: The minimum BPM\r\n * @returns An array of tracks matching the metadata\r\n */\r\nexport async function dz_advanced_track_search(options: DeezerAdvancedSearchOptions): Promise<DeezerTrack[]> {\r\n    const limit = options.limit ?? 10;\r\n\r\n    if (limit > 100) throw new Error('The maximum search limit for Deezer is 100');\r\n    if (limit < 1) throw new Error('The minimum search limit for Deezer is 1');\r\n\r\n    const metadata: string[] = [];\r\n    if (options.artist) metadata.push(`artist:\"${encodeURIComponent(options.artist)}\"`);\r\n\r\n    if (options.album) metadata.push(`album:\"${encodeURIComponent(options.album)}\"`);\r\n\r\n    if (options.title) metadata.push(`track:\"${encodeURIComponent(options.title)}\"`);\r\n\r\n    if (options.label) metadata.push(`label:\"${encodeURIComponent(options.label)}\"`);\r\n\r\n    if (Number(options.minDurationInSec) !== NaN) metadata.push(`dur_min:${options.minDurationInSec}`);\r\n\r\n    if (Number(options.maxDurationInSec) !== NaN) metadata.push(`dur_max:${options.maxDurationInSec}`);\r\n\r\n    if (Number(options.minBPM) !== NaN) metadata.push(`bpm_min:${options.minBPM}`);\r\n\r\n    if (Number(options.maxBPM) !== NaN) metadata.push(`bpm_max:${options.maxBPM}`);\r\n\r\n    if (metadata.length === 0) throw new Error('At least one type of metadata is required.');\r\n\r\n    const response = await request(`https://api.deezer.com/search/track/?q=${metadata.join(' ')}&limit=${limit}`).catch(\r\n        (err: Error) => err\r\n    );\r\n\r\n    if (response instanceof Error) throw response;\r\n\r\n    const jsonData = JSON.parse(response);\r\n\r\n    if (jsonData.error) {\r\n        throw new Error(`Deezer API Error: ${jsonData.error.type}: ${jsonData.error.message}`);\r\n    }\r\n\r\n    const results = jsonData.data.map((track: any) => new DeezerTrack(track, true));\r\n\r\n    return results;\r\n}\r\n"]}