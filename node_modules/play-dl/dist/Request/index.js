"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.request = exports.request_stream = void 0;
const classes_1 = require("./classes");
function request_stream(req_url, options = { method: 'GET' }) {
    return new Promise(async (resolve, reject) => {
        let res = new classes_1.Response(req_url, options);
        await res.stream();
        if (res.statusCode >= 300 && res.statusCode < 400) {
            res = await request_stream(res.headers.location, options);
            await res.stream();
        }
        resolve(res);
    });
}
exports.request_stream = request_stream;
function request(req_url, options = { method: 'GET' }) {
    return new Promise(async (resolve, reject) => {
        let res = new classes_1.Response(req_url, options);
        await res.fetch();
        if (Number(res.statusCode) >= 300 && Number(res.statusCode) < 400) {
            res = await request(res.headers.location, options);
        }
        else if (Number(res.statusCode) > 400) {
            reject(new Error(`Got ${res.statusCode} from the request`));
        }
        resolve(res);
    });
}
exports.request = request;
//# sourceMappingURL=index.js.map